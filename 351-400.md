## [394. Decode String - Medium](https://leetcode.com/problems/decode-string/)

```python
class Solution:
  def decodeString(self, s: str) -> str:
    L = len(s)
    def decode(idx):
      tmp = []
      k = 0
      while idx < L and s[idx] != ']':
        c = s[idx]
        if c.isalpha():
          tmp.append(c)
          idx += 1
        elif c.isdigit():
          k = k*10 + int(c)
          idx += 1
        else:  # '['
          r, idx = decode(idx+1)
          tmp.append(k*r)
          k = 0

      return ''.join(tmp), idx + 1
    r, _ = decode(0)
    return r
```

```python
# smart stack method in discussion
class Solution:
  def decodeString(self, s: str) -> str:
    stack = []; cur_str = []; cur_k = 0
    for c in s:
      if c.isalpha():
        cur_str.append(c)
      elif c.isdigit():
        cur_k = cur_k * 10 + int(c)
      elif c == '[':
        stack.append(''.join(cur_str))
        stack.append(cur_k)
        cur_str = []
        cur_k = 0
      else:  # ']'
        pre_k = stack.pop()
        pre_str = stack.pop()
        cur_str = [pre_str + pre_k * ''.join(cur_str)]
    return ''.join(cur_str)
```

## [399. Evaluate Division - Medium](https://leetcode.com/problems/evaluate-division/)

```python
from collections import defaultdict

class Solution:
  def calcEquation(self, equations: List[List[str]], values: List[float], queries: List[List[str]]) -> List[float]:
    graph = defaultdict(dict)
    for (dividend, divisor), val in zip(equations, values):
      graph[dividend][divisor] = val
      graph[divisor][dividend] = 1/val

    def compute(start, end):
      if start not in graph or end not in graph:
        return -1.0

      seen = set([start])
      stack = [(start, 1.0)]
      while stack:
        node, val = stack.pop()
        if node == end:
          return val
        for neigh, factor in graph[node].items():
          if neigh not in seen:
            stack.append([neigh, val * factor])
            seen.add(neigh)
      return -1.0

    ans = []
    for start, end in queries:
      ans.append(compute(start, end))
    return ans
```